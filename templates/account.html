{% extends "base.html" %}


{%block user_account%}
<!-- Bootstrap accordion  -->

  <div class="container">
    <div class="panel-group" id="accordion">
      <!--"My books" drop-down accordion menu item. Contains the books submitted by the user"-->
      <div class="panel panel-default">
        <!-- inline style used to override bootstrap styles -->
        <div class="panel-heading" style="color:#337ab7">
          <h4 class="panel-title">
            <a class="accordion" data-toggle="collapse" data-parent="#accordion" href="#collapse1"><i
                class="fas fa-book-reader"></i> My books</a>
          </h4>
        </div>
        <div id="collapse1" class="panel-collapse collapse ">
          <div class="panel-body">
            {%for eachBook in books%}
            <div class="account_wrapper">
              <div id="title_account">
                {{ eachBook.title}}
              </div>
              
              <div id="delete">
                  <!--form, if submitted, deletes the book titled - "{{eachBook.title}}"-->
                <form action="{{ url_for('account') }}" method="POST" id="delete_book_form">
                  <input type="hidden" name="book_id" value="{{eachBook._id}}">
                  <input type="hidden" name="id" value="delete_book">
                  <button><i class="far fa-trash-alt"></i> Delete</button>
                </form>
              </div>

              <div id="edit">
                <!-- a button, if clicked brings the pop-up that allows to edit the information of the book titled - "{{eachBook.title}}" -->
                <button type="button" data-toggle="modal" data-target="#{{eachBook._id}}"><i
                    class="far fa-edit"></i>Edit</button>
              </div>

            </div>
            <!--Bootstrap modal. Contains an iFrame with the book editing form-->
            <div class="modal fade" id="{{eachBook._id}}" role="dialog">
              <div class="modal-dialog">

                <!-- Modal content-->
                <div class="modal-content">
                  <div class="modal-header">
                    <div class="contactFormHeader">
                      <h4>Edit "{{eachBook.title}}"</h4>
                    </div>
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                  </div>
                  <div class="modal-body">
                    <iframe id="editFrame" name="edit" frameborder="no" src="/edit_book{{eachBook._id}}"></iframe>
                  </div>
                  <div class="modal-footer">
                    <button type="button" class="btn-close btn btn-default btn-sm" data-dismiss="modal">
                      Close
                    </button>
                  </div>
                </div>

              </div>
            </div>
            <br>
            {%endfor%}
          </div>
        </div>
      </div>

      <!--"My reviews" drop-down accordion menu item. Contains the user's revews"-->
      <div class="panel panel-default">
        <!-- inline style used to override bootstrap styles -->
        <div class="panel-heading" style="color:#337ab7">
          <h4 class="panel-title">
            <a class="accordion" data-toggle="collapse" data-parent="#accordion" href="#collapse2"><i
                class="fas fa-comment-dots"></i></i> My reviews</a>
          </h4>
        </div>
        <div id="collapse2" class="panel-collapse collapse">
          <div class="panel-body">
            {%for eachReview in reviews%}
            <div class="account_wrapper">
              <div id="title_account">
                {{ eachReview.title}}
              </div>

              <div id="delete">
                <!--form, if submitted, deletes the review titled - "{{eachReview.title}}"-->
                <form action="{{ url_for('account') }}" method="POST" id="delete_review_form">
                  <input type="hidden" name="review_id" value="{{eachReview._id}}">
                  <input type="hidden" name="id" value="delete_review">
                  <button><i class="far fa-trash-alt"></i> Delete</button>
                </form>
              </div>

              <div id="edit">
                <!-- a button, if clicked brings the pop-up that allows to edit the review titled - "{{eachReview.title}}" -->
                <button type="button" data-toggle="modal" data-target="#{{eachReview._id}}"><i
                    class="far fa-edit"></i>Edit</button>
              </div>
            </div>

            <!--Bootstrap modal. Cotains an iFrame with the review editing form-->
            <div class="modal fade" id="{{eachReview._id}}" role="dialog">
              <div class="modal-dialog">

                <!-- Modal content-->
                <div class="modal-content">
                  <div class="modal-header">
                    <div class="contactFormHeader">

                      <h4>Edit review"</h4>
                    </div>
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                  </div>

                  <div class="modal-body">
                  
                    <iframe class="feedback" name="edit" frameborder="no" src="/edit_review{{eachReview._id}}"></iframe>




                  </div>
                  <div class="modal-footer">
                    <button type="button" class="btn-close btn btn-default btn-sm" data-dismiss="modal">
                      Close
                    </button>
             
                    
                  </div>
                </div>

              </div>
            </div>



            <br>
            {%endfor%}
          </div>
        </div>
      </div>

    </div>
  </div>




  <script>



  function validate() {
    var title = document.getElementById('title').value;

    var description = document.getElementById('description').value;
    var genre = document.getElementById('add_genre').value;
    if (title == "") {
      document.getElementById("titleError").innerHTML = "Please fill in this field";
    }
    else {
      document.getElementById("titleError").innerHTML = ""
    }
    if (description == "") {
      document.getElementById("descriptionError").innerHTML = "Please fill in this field";
    }
    else {
      document.getElementById("descriptionError").innerHTML = ""
    }
    if (genre == "Choose genre") {
      document.getElementById("genreError").innerHTML = "Please choose genre";
    }
    else {
      document.getElementById("genreError").innerHTML = ""
    }
    if (title != "" && description != "" && genre != "Choose genre") { document.getElementById("add_book_form").submit(); }
  }

  
</script>



{%endblock%}