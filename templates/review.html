{% extends "base.html" %}

{%block review%}
<!-- override gllobal svg style  -->
<style>
    svg {width: 1.8em; height: 2em}
 </style>  
<!-- if review was already submitted do not show the form -->
{%if status != True%}
<form action="/review:bookID:{{book_id}}" method="POST" id="review_form" name="review_form" >
        <label for="title">Title</label><br>
        <input type="text" name="title" id="title" value="" ><span id="titleError"></span><br>

        <label for="comment">Your comment</label><br>
      

         <textarea rows="4" cols="50" name="comment" id="comment" ></textarea> <span id="reviewError"></span><br>
         
            <span >
                <svg style="display: none">
                    <symbol id="star" viewBox="0 0 98 92">
                    <title>star</title>
                    <path d='M49 73.5L22.55 87.406l5.05-29.453-21.398-20.86 29.573-4.296L49 6l13.225 26.797 29.573 4.297-21.4 20.86 5.052 29.452z' fill-rule='evenodd'/>
                  </svg>
                  How many stars would you give?<br>
                  <div style="display: inline-block">
                    <div id="stars" class="stars">
                      <a class="star" href="javascript:void(0)"><svg><use xlink:href="#star"></use></svg></a>
                      <a class="star" href="javascript:void(0)"><svg><use xlink:href="#star"></use></svg></a>
                      <a class="star" href="javascript:void(0)"><svg><use xlink:href="#star"></use></svg></a>
                      <a class="star" href="javascript:void(0)"><svg><use xlink:href="#star"></use></svg></a>
                      <a class="star" href="javascript:void(0)"><svg><use xlink:href="#star"></use></svg></a>
                    </div>
                  </div>
                
                
             </span><span id="ratingError"></span><br>
        <input type="hidden" name="book_id" value="{{book_id}}">
        <input type="hidden" name="rating" id="rating" value = 0>
        
      
      </form>

                  
  
        
                       <button id="submit" onclick="validate()">submit</button>
        
        

           
                
        
   
        
        
        
                          <script>
                          
        var starContainer = document.getElementById('stars')
        var stars = Array.prototype.slice.call(starContainer.children)
        var totalStars = stars.length
        var rated = document.getElementById('rated')
        
       
        starContainer.addEventListener('click', function(e) {
          var index = stars.indexOf(e.target)
          var count = totalStars - index;
          stars.forEach(el => el.classList.remove('is-selected'))
          e.target.classList.add('is-selected')
          document.getElementById("rating").value = count;
        })


        function validate() {
           var title =  document.getElementById('title').value;
          
          var review = document.getElementById('comment').value;
           var rating = document.getElementById('rating').value;
          if (title == ""){
           document.getElementById("titleError").innerHTML = "Please fill in this field";}
          else{
            document.getElementById("titleError").innerHTML =""
          }
          if (review == ""){
           document.getElementById("reviewError").innerHTML = "Please fill in this field";}
          else{
            document.getElementById("reviewError").innerHTML = ""
          }
          if (rating == "0"){
           document.getElementById("ratingError").innerHTML = "Please fill in this field";}
          else{
            document.getElementById("ratingError").innerHTML = ""
          }
          if(title != "" && review != "" && rating != "0"){document.getElementById("review_form").submit();}
}


            </script>

{%else%}
   
<h4>thank you for your review</h4>
<p>You can go back 
<a href="/Book_page/book_id:{{book_id}}">here</a>
</p>
{%endif%} 
{%endblock%}


